
R version 3.3.0 (2016-05-03) -- "Supposedly Educational"
Copyright (C) 2016 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(nlme)
> data(petrol, package = 'MASS')
> Petrol <- petrol
> Petrol[, 2:5] <- scale(Petrol[, 2:5], scale = FALSE)
> pet3.lme <- lme(Y ~ SG + VP + V10 + EP,
+                 random = ~ 1 | No, data = Petrol, method="ML")
> upet3 <- update(pet3.lme, Y ~ SG + VP + V10)
> upet3
Linear mixed-effects model fit by maximum likelihood
  Data: Petrol 
  Log-likelihood: -118.1028
  Fixed: Y ~ SG + VP + V10 
(Intercept)          SG          VP         V10 
19.65937500  0.12504563  2.27818601  0.06724136 

Random effects:
 Formula: ~1 | No
         (Intercept) Residual
StdDev: 0.0002939347 9.696578

Number of Observations: 32
Number of Groups: 10 
> vc3 <- VarCorr(upet3)
> upet2 <- lme(Y ~ SG + VP + V10, random = ~ 1 | No, data = Petrol, method = "ML")
> stopifnot(
+     all.equal(upet3, upet2, tol = 1e-15)
+     ,
+     all.equal(fixef(upet3),
+ 	      c("(Intercept)" = 19.659375, SG = 0.125045632,
+ 		VP = 2.27818601, V10 = 0.0672413592), tol = 1e-8)# 1e-9
+     ,
+     all.equal(as.numeric(vc3[,"StdDev"]),
+ 	      c(0.00029397, 9.69657845), tol=1e-6)
+ )
> 
> 
> 
> proc.time()
   user  system elapsed 
  0.196   0.008   0.202 
